import { Schema, model, models, Model } from 'mongoose';
import { ISetting } from '@/types/schema';

export const defaultSetting = {
  blogName: 'iBlog',
  blogSlogan: '',
  blogLogo: 'data:image/png;base64,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',
  recordInfo: '',
  showBlogIntro: true,
  blogIntro: '',
  postPageSize: 10,
  enablePreview: true,
  showLicense: true,
  enableComments: true,
  commentPageSize: 20,
  enableStatistics: false,
  statisticsKey: ''
} as ISetting;

export class Setting {
    private _model: Model<ISetting>;

    constructor () {
      const schema = new Schema<ISetting>({
        blogName: { type: String },
        blogSlogan: { type: String },
        blogLogo: { type: String },
        recordInfo: { type: String },
        showBlogIntro: { type: Boolean },
        blogIntro: { type: String },
        postPageSize: { type: Number },
        enablePreview: { type: Boolean },
        showLicense: { type: Boolean },
        enableComments: { type: Boolean },
        commentPageSize: { type: Number },
        enableStatistics: { type: Boolean },
        statisticsKey: { type: String }
      });

      // 初始化默认系统设置
      schema.statics.initData = () => {
        this.model.exists({}).then(exist => {
          if (!exist) {
            this.model.create(defaultSetting);
          }
        });
      };

      if (models.setting) {
        this._model = models.setting;
      } else {
        this._model = model<ISetting>('setting', schema, 'setting');
      }
    }

    public get model (): Model<ISetting> {
      return this._model;
    }
}
